"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,r=!0,s=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return r=e.done,e},e:function(e){s=!0,a=e},f:function(){try{r||null==o.return||o.return()}finally{if(s)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var jokesSection=document.getElementById("jokes"),favSection=document.getElementById("favourite"),menuButtonOpen=document.getElementById("open"),menuButtonClose=document.getElementById("close"),controlSection=document.getElementById("control-menu"),radioButtons=controlSection.querySelectorAll('input[type="radio"]'),categoryButtons=document.getElementById("buttons"),searchInput=document.getElementById("search-input"),loadingText=document.getElementById("loading"),fillFormWarn=document.getElementById("fill-form-warn"),ifEmptyText=document.getElementById("emptyFavSection"),overlay=document.getElementById("overlay"),urlList={categoryList:"https://api.chucknorris.io/jokes/categories",category:"https://api.chucknorris.io/jokes/random?category=",random:"https://api.chucknorris.io/jokes/random",search:"https://api.chucknorris.io/jokes/search?query="},jokes=[],favJokes=[];function init(){getLocalStorageData(),getCategories(),ifEmptyFavSection()}function getLocalStorageData(){var e=localStorage.getItem("favJokes");null!==e&&"null"!==e&&(favJokes=JSON.parse(e)).forEach(function(e){createJokeEl(e,favSection)})}function getCategories(){fetch(urlList.categoryList).then(function(e){return e.json()}).then(function(e){createButtons(e),loadingText.style.display="none"}).catch(function(e){loadingText.style.display="none";var t=document.createElement("p");t.innerHTML="Can't receive categories (".concat(e,")"),categoryButtons.append(t),console.log(e)})}function ifEmptyFavSection(){0!==favJokes.length?ifEmptyText.style.display="none":ifEmptyText.style.display="block"}function createButtons(e){e.map(function(e){var t=document.createElement("button");t.type="button",t.innerHTML=e,t.className="btn category",t.value=e,categoryButtons.append(t)})}function toggleFavSection(){var t,e=this;e===menuButtonOpen?(t=menuButtonClose,favSection.classList.add("slide"),overlay.style.display="block"):(e=menuButtonClose,t=menuButtonOpen,favSection.classList.remove("slide"),overlay.style.display="none"),e.style.opacity="0",favSection.ontransitionend=function(e){e.target===favSection&&(t.style.opacity="1")}}function setSearch(e){var t=e.target.classList;t.contains("category")?selectCategory(e.target):t.contains("opt-radio")?showOptions():t.contains("get-joke")&&getJoke()}function selectCategory(e){var t=e.parentElement.getElementsByClassName("active")[0];t&&t.classList.remove("active"),e.classList.add("active")}function showOptions(){var e,t=_createForOfIteratorHelper(radioButtons);try{for(t.s();!(e=t.n()).done;){var n=e.value,o=n.parentElement.getElementsByClassName("optional")[0];n.checked&&o?(o.style.display="block",o.firstElementChild.focus()):!n.checked&&o&&(o.style.display="none")}}catch(e){t.e(e)}finally{t.f()}}function getJoke(){var e,t,n=_createForOfIteratorHelper(radioButtons);try{for(n.s();!(t=n.n()).done;){var o=t.value;o.checked&&(e=o.value)}}catch(e){n.e(e)}finally{n.f()}var a=getUrl(e);if(!a)return fillFormWarn.style.display="block",void setTimeout(function(){fillFormWarn.style.display="none"},1e3);getData(a)}function getUrl(e){var t,n;switch(e){case"random":t=urlList.random;break;case"category":if(!(n=document.getElementsByClassName("active")[0]))return;t=urlList.category+n.value;break;case"search":if(!(n=document.getElementsByClassName("search")[0]).value)return;t=urlList.search+n.value;break;default:return}return t}function getData(e){fetch(e).then(function(e){return e.json()}).then(function(e){var t=[],t=e.hasOwnProperty("result")?e.result:[e];jokes.push.apply(jokes,_toConsumableArray(t)),t.forEach(function(e){createJokeEl(e,jokesSection)})}).catch(function(e){console.log(e)})}function createJokeEl(e,t){var n=document.getElementsByTagName("template")[0].content.cloneNode(!0);t.insertBefore(n,t.firstChild);var o=t.firstElementChild,a=o.getElementsByClassName("save")[0];a.setAttribute("data-id",e.id),t.classList.contains("favourite")?a.src="./images/heart-fill.svg":a.src="./images/heart.svg";var r=o.getElementsByClassName("joke-link")[0];r.href=e.url,r.textContent=e.id,o.getElementsByClassName("text")[0].textContent=e.value;var s,i=o.getElementsByClassName("hours")[0],c=new Date-new Date(e.updated_at),l=Math.round(c/36e5);return i.textContent=l+" hours ago",e.categories.length&&((s=document.createElement("button")).type="button",s.innerHTML=e.categories[0],s.className="btn",o.getElementsByClassName("footer")[0].append(s)),o}function markJoke(e){var t,n,o,a=e.target;"save"===a.className&&(a.src.includes("fill.svg")?(a.src="./images/heart.svg",favJokes=favJokes.filter(function(e){return e.id!==a.dataset.id}),e.target.closest(".favourite")?(o=a.closest(".joke"),(n=_toConsumableArray(jokesSection.getElementsByClassName("save")).filter(function(e){return e.dataset.id===a.dataset.id}))[0]&&(n[0].src="./images/heart.svg")):o=_toConsumableArray(favSection.getElementsByClassName("save")).filter(function(e){return e.dataset.id===a.dataset.id})[0].closest(".joke"),o.remove()):(a.src="./images/heart-fill.svg",t=jokes.filter(function(e){return e.id===a.dataset.id}),favJokes.push.apply(favJokes,_toConsumableArray(t)),createJokeEl.apply(void 0,_toConsumableArray(t).concat([favSection]))),ifEmptyFavSection(),localStorage.setItem("favJokes",JSON.stringify(favJokes)))}init(),menuButtonOpen.addEventListener("click",toggleFavSection),menuButtonClose.addEventListener("click",toggleFavSection),overlay.addEventListener("click",toggleFavSection),controlSection.addEventListener("click",setSearch),searchInput.addEventListener("keydown",function(e){"Enter"===e.key&&getJoke()}),jokesSection.addEventListener("click",markJoke),favSection.addEventListener("click",markJoke);
//# sourceMappingURL=script.min.js.map
